\usepackage[plainpages=false,
    pdfcenterwindow=true,
    pdftoolbar=false,
    pdfmenubar=false,
    pdfauthor={\CompanyName},
    pdftitle={Facture \InvoiceNumber\ -- \CompanyName},
    pdfsubject={Facture \InvoiceNumber},
    pdfkeywords={},
    pdfproducer={Latex with hyperref},
    pdfcreator={pdflatex},
    linkcolor=black,
    citecolor=black,
    filecolor=black,
    urlcolor=black]{hyperref}

% ##############################################################################
% ##############################################################################
%	Document
% ##############################################################################

\begin{document}


\thispagestyle{pagestyle_firstpage}

% %  Géometrie page de garde
% \newgeometry{
%     tmargin=1cm,
%     bmargin=3cm,
%     lmargin=2cm,
%     rmargin=2cm
% }

% %%  Default geometry
% \newgeometry{
% 	tmargin=2cm,
% 	bmargin=3cm,
% 	lmargin=2cm,
% 	rmargin=2cm
% }

%%  Trick to reset geometry on second page;
%%  See https://tex.stackexchange.com/a/478566/166035
%%  This line registers the reset-hook:
% \AddEverypageHook{
%     \ifnum\value{page}=1
%         %%  Géometrie page de garde
%         \newgeometry{
%             a4paper,
%             tmargin=1cm,
%             bmargin=3cm,
%             lmargin=2cm,
%             rmargin=2cm
%         }
%         % \setlength{\textheight}{\paperheight}
%         % \addtolength{\textheight}{ - 4cm }
%     \else
%         % %%  Default geometry
%         % \newgeometry{
%         %     tmargin=3cm,
%         %     bmargin=3cm,
%         %     lmargin=2cm,
%         %     rmargin=2cm
%         % }
%     \fi
% }


% ------------------------------------------------------------------------------
%	Generate the invoice header
% ------------------------------------------------------------------------------
\makeheader{}


% ------------------------------------------------------------------------------
%	Description of the invoice content
% ------------------------------------------------------------------------------
% ~\\
\ifdef{\InvoiceSubject}{
	\textbf{Objet : \InvoiceSubject \\}
}{
	% N/A
}

% \textnormal{\InvoiceComplementaryInfos}
\ifdef{\InvoiceDetails}{
	\InvoiceDetails
}{
	% N/A
}


% ------------------------------------------------------------------------------
%	Generate the invoice listing
% ------------------------------------------------------------------------------
% \vspace{10mm}

\ProductsTable{}
\InvoiceComplementaryInfos


% ------------------------------------------------------------------------------
%	Insert payment conditions
% ------------------------------------------------------------------------------

% Fill all the available vertical space
\vfill
\vfill
\begin{minipage}{\textwidth}
    % \hrulefill
    \doublerulefill
    \vspace{1em}

    \PaymentConditions

    \vspace{1em}
    \doublerulefill
\end{minipage}



\end{document}
