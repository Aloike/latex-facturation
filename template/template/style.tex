\usepackage{changepage}
\usepackage{fancyhdr}
\usepackage{titlesec}


% Space between \paragraph titles (different from paragraphs!)
% See https://tex.stackexchange.com/a/4896/166035
% And https://tex.stackexchange.com/a/509643/166035
\titlespacing*{\paragraph}{
	% Left margin
	0pt
}{
	% Space before (vertical)
	0.5\baselineskip plus 1ex minus 0.2ex
}{
	% Space after (horizontal)
	1em
}

% Space between paragraphs, with an hysteresis of "plus"/"minus" given values
% \setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}

% \setlength{\parindent}{0pt}


% \thispagestyle{fancy}
\pagestyle{fancy}


% ##############################################################################
% ##############################################################################
%	Headers / Footers
% ##############################################################################

% \renewcommand{\headrulewidth}{0.5pt}


% ------------------------------------------------------------------------------
%	Definition of default header and footer
% ------------------------------------------------------------------------------

\newcommand{\HeaderDefaultL}{
	% \textbf{\CompanyName} \\
	% \#\InvoiceNumber \\
	% \CompanyInternalRef \\
	% Facture \\
	% \InvoiceDate
	% ~\\
}

\newcommand{\HeaderDefaultC}{
	% \CompanyName \\
	% \Large \textbf{FACTURE} \\
	\InvoiceTitle \\
	% \#\InvoiceNumber \\
	% \CompanyInternalRef
	% \InvoiceDate
}

\newcommand{\HeaderDefaultR}{
	% \CompanyName \\
	% \CompanyInternalRef \\
	% Facture \\
	\#\InvoiceNumber \\
	\InvoiceDate \\
}

% ------------------------------------------------------------------------------

\newcommand{\FooterDefaultL}{
	% \ClientNom \\
	% \#\InvoiceNumber \\
	% \CompanyInternalRef \\
	% Facture \\
	% \InvoiceDate
}

\newcommand{\FooterDefaultC}{
	\small{
		% \vspace{0.5em}
		\CompanyName \\
	}
	\footnotesize{
		Téléphone: \CompanyPhone ~--~ E-mail: \href{mailto:\CompanyEmail}{\texttt{\CompanyEmail}}\\
		SIRET \CompanySiret ~--~ Code APE \CompanyAPE\\
	}
	\tiny{
		% \vspace{1.2em}
		\vspace{1.0em}
		Dispensé d'immatriculation au registre du commerce et des sociétés et au répertoire des métiers
	}
}

\newcommand{\FooterDefaultR}{
	% ~\\
	% Facture \\
	% \#\InvoiceNumber \\
	% \InvoiceDate \\
	% ~\\
	\vspace{1.0em}
	Page \thepage / \pageref{LastPage}
}



% ------------------------------------------------------------------------------
%	Apply default header and footer
% ------------------------------------------------------------------------------

\fancyhead[L]{
	\HeaderDefaultL
}

\fancyhead[C]{
	\HeaderDefaultC
}

\fancyhead[R]{
	\HeaderDefaultR
}


\newcommand{\footerOffset}{- \geometryFootSkip + 5mm}

% \renewcommand{\footrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{1pt}
\renewcommand{\footrule}{%
	% \checkoddpage
	% \ifoddpage
	% 	\hfill
	% \else
	% \fi
	% \vspace{- \geometryFootSkip}
	% \vspace{ \footerOffset }
	% \rule{\textwidth}{\footrulewidth}
	% \vskip \geometryFootSkip
}


\fancyfoot[L]{
	\vspace{ \footerOffset }
	\FooterDefaultL
}

\fancyfoot[C]{
	% \vspace{- \geometryMarginBottom}
	\vspace{ \footerOffset }
	\rule{\textwidth}{\footrulewidth}
	\FooterDefaultC
}

\fancyfoot[R]{
	% \vspace{- \geometryFootSkip}
	\vspace{ \footerOffset }
	\FooterDefaultR
}

% ------------------------------------------------------------------------------
%	Definition of a pagestyle for the first page header and footer
% ------------------------------------------------------------------------------
\fancypagestyle{pagestyleFirstpage}
{
	\pagestyle{fancy}

	\changepage{
		% Text height
	}{
		% Text width
	}{
		% Even side margin
	}{
		% Odd side margin
	}{
		% Column sep
	}{
		% Top margin
		-2 cm
	}{
		% Head height
	}{
		% Head sep
	}{
		% Foot skip
		2 cm
	}

	% \setlength{\headheight}{1cm}

	% \newlength{\geometryVerticalOffsetPdg}
	% \setlength{\geometryVerticalOffsetPdg}{-1in}%< offset is added to a 1in margin, so remove it for calculations.
	% \addtolength{\geometryVerticalOffsetPdg}{1cm} %< This will be the actual margin.
	% \setlength{\voffset}{\geometryVerticalOffsetPdg}

	% %  Géometrie page de garde
	% \newgeometry{
	% 	tmargin=1cm,
	% 	bmargin=\geometryMarginBottom, %3cm,
	% 	lmargin=\geometryMarginLeft, %2cm,
	% 	rmargin=\geometryMarginRight, %2cm
	% }
	% \newlength{\geometryTextHeightPdg}
	% \setlength{\geometryTextHeightPdg}{\paperheight}
	% \addtolength{\geometryTextHeightPdg}{- 1cm}
	% \addtolength{\geometryTextHeightPdg}{- \geometryMarginBottom}
	% \setlength{\textheight}{\geometryTextHeightPdg}


	% Remove the rule at the bottom of the header
	\renewcommand{\headrule}{\hrule height 0pt}

	% Clear definitions of header/footer
	\fancyhf{}


	%
	%	Set the footer of the first page
	%
	\fancyfoot[L]{
		\vspace{ \footerOffset }
		\FooterDefaultL
	}

	\fancyfoot[C]{
		\vspace{ \footerOffset }
		\rule{\textwidth}{\footrulewidth}
		\FooterDefaultC
	}

	\fancyfoot[R]{
		\vspace{ \footerOffset }
		\FooterDefaultR
	}
}

% ##############################################################################
% ##############################################################################
